<html>
<head>
  <script type="text/javascript" src="../src/JspScript.js"></script>

  <script type="text/javascript" src="generated.js"></script>
  <script type="text/javascript">
    var env = new JspScript.Env();

    env.registerTaglib('/WEB-INF/tags/x', {
      test: env.locateTemplate('WEB-INF/tags/x/test.tag')
    });

    env.registerTaglib('http://jspscript.sourceforge.net/demo/xfns/1.0', {}, {
      includeUrlText: function(url) {
        var xhrRequest;
        if (window.XMLHttpRequest) {
          xhrRequest = new XMLHttpRequest();
        } else {
          xhrRequest = new ActiveXObject("Microsoft.XMLHTTP");
        }
        if (!xhrRequest) {
          throw new Error("can't create XHR");
        }

        xhrRequest.open("GET", url, false);
        xhrRequest.send(null);
        return document.createTextNode(xhrRequest.responseText);
      }
    });

  </script>
</head>
<body>
<script type="text/javascript">
  env.render('WEB-INF/jsp/page.jsp', {value: 'works'}, document.body);
</script>
</body>
</html>
